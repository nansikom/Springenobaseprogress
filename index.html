<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostgreSQL Frontend</title>
    <link href="https://unpkg.com/tabulator-tables@5.6.2/dist/css/tabulator.min.css" rel="stylesheet">

  <!-- Tabulator JS (goes in head or end of body) -->
    <script src="https://unpkg.com/tabulator-tables@5.6.2/dist/js/tabulator.min.js"></script>
</head>
<body>
    <h1>PostgreSQL Frontend</h1>

    <h2>Add Numbers</h2>
    <input type="number" id="num1" placeholder="Enter first number">
    <input type="number" id="num2" placeholder="Enter second number">
    <button onclick="addNumbers()">Add</button>
    <p id="add-result"></p>

    <h2>Calculate Overall Price</h2>
    <button onclick="calculateOverallPrice()">Calculate</button>
    <p id="price-result"></p>

    <script>
        async function addNumbers() {
            const num1 = document.getElementById('num1').value;
            const num2 = document.getElementById('num2').value;

            const response = await fetch(`http://localhost:3000/add-numbers?a=${num1}&b=${num2}`);
            const data = await response.json();
            document.getElementById('add-result').innerText = `Sum: ${data.sum}`;
        }

        async function calculateOverallPrice() {
            const response = await fetch('http://localhost:3000/calculate-overall-price');
            const data = await response.json();
            document.getElementById('price-result').innerText = `Total Price: ${data.total_price}`;
        }
    </script>
      <div id="example-table"></div>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
          var table = new Tabulator("#example-table", {
              data: [{item: "Pen", qty: 3, price: 2}], 
              columns: [
                  {title: "Item", field: "item"},
                  {title: "Qty", field: "qty", editor: "number"},
                  {title: "Price", field: "price", editor: "number"},
                  {title: "Total", field: "total", mutator: (value, data) => data.qty * data.price}
              ]
          });
        });
      </script>
    

</body>
</html>



<script>
  app.get('/dynamic_query', async (req, res) => {
    try {
        const result = await client.query('SELECT public.dynamic_query() AS sort_col;');
        res.json({ sort_col: result.rows[0].sort_col });
    } catch (err) {
        console.error('Error executing query:', err);
        res.status(500).json({ error: 'Internal Server Error' });
    }
});
</script>